From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Spottedleaf <spottedleaf@spottedleaf.dev>
Date: Sun, 21 Jun 2020 17:25:10 -0700
Subject: [PATCH] Fix skull NPE


diff --git a/src/main/java/net/minecraft/server/TileEntitySkull.java b/src/main/java/net/minecraft/server/TileEntitySkull.java
index a1f432d6a6ba16b458b87b9332af47df4e91df37..509bc01bdebf4e9475b764f7c99b9dafb0b79fca 100644
--- a/src/main/java/net/minecraft/server/TileEntitySkull.java
+++ b/src/main/java/net/minecraft/server/TileEntitySkull.java
@@ -186,7 +186,7 @@ public class TileEntitySkull extends TileEntity /*implements ITickable*/ { // Pa
     private void f() {
         // Spigot start
         GameProfile profile = this.gameProfile;
-        if (profile.isComplete() && profile.getProperties().containsKey("textures")) return; // Paper
+        if (profile != null && profile.isComplete() && profile.getProperties().containsKey("textures")) return; // Paper // Tuinity - null check
         b(profile, new Predicate<GameProfile>() {
 
             @Override
diff --git a/src/main/java/org/bukkit/craftbukkit/inventory/CraftMetaSkull.java b/src/main/java/org/bukkit/craftbukkit/inventory/CraftMetaSkull.java
index 2a3c86b0cbce0c37ebd8cace138c72c99f7455ea..75ee35665a52ac8b00add9f9bff3396d5ffe1388 100644
--- a/src/main/java/org/bukkit/craftbukkit/inventory/CraftMetaSkull.java
+++ b/src/main/java/org/bukkit/craftbukkit/inventory/CraftMetaSkull.java
@@ -75,9 +75,11 @@ class CraftMetaSkull extends CraftMetaItem implements SkullMeta {
 
     private void setProfile(GameProfile profile) {
         // Paper start
+        if (profile != null) { // Tuinity - null check
         com.destroystokyo.paper.profile.CraftPlayerProfile paperProfile = new com.destroystokyo.paper.profile.CraftPlayerProfile(profile);
         paperProfile.completeFromCache();
         profile = paperProfile.getGameProfile();
+        } // Tuinity - null check
         // Paper end
         this.profile = profile;
         this.serializedProfile = (profile == null) ? null : GameProfileSerializer.serialize(new NBTTagCompound(), profile);
